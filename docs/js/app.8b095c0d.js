(function(e){function t(t){for(var a,r,o=t[0],l=t[1],c=t[2],p=0,d=[];p<o.length;p++)r=o[p],s[r]&&d.push(s[r][0]),s[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==s[l]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={1:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/teams-blast-messenger/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([10,0]),n()})({10:function(e,t,n){e.exports=n("zUnb")},6:function(e,t){},7:function(e,t){},"9kDp":function(e,t,n){},EDI0:function(e,t,n){},GYlk:function(e,t,n){},R7cQ:function(e,t,n){},TYme:function(e,t,n){},Vd6l:function(e,t,n){},ZL7j:function(e,t,n){"use strict";var a=n("EDI0"),s=n.n(a);s.a},agAK:function(e,t,n){"use strict";var a=n("Vd6l"),s=n.n(a);s.a},j95Z:function(e,t,n){"use strict";var a=n("GYlk"),s=n.n(a);s.a},lHKg:function(e,t,n){"use strict";var a=n("R7cQ"),s=n.n(a);s.a},m2cr:function(e,t,n){"use strict";var a=n("9kDp"),s=n.n(a);s.a},xcxa:function(e,t,n){"use strict";var a=n("TYme"),s=n.n(a);s.a},zUnb:function(e,t,n){"use strict";n.r(t);n("VRzm");var a=n("Kw5r"),s=n("e7F3"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],o=(n("ZL7j"),n("KHd+")),l={},c=Object(o["a"])(l,i,r,!1,null,null,null),u=c.exports,p=n("jE9Z"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"})},f=[],v=n("xmWZ"),h=n("3Aqn"),m=n("0yhX"),b=n("EdlT"),g=n("mrSG"),k=n("YKMj"),j=function(e){function t(){return Object(v["a"])(this,t),Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(k["b"]);j=g["a"]([k["a"]],j);var O=j,y=O,C=Object(o["a"])(y,d,f,!1,null,null,null),_=C.exports,w=function(){var e=this,t=this,n=t.$createElement,a=t._self._c||n;return a("div",[a("hero",{attrs:{title:"Blast Message App"}}),a("section",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"section"},[a("div",{staticClass:"container"},[a("access-token",{on:{save:t.onTokenSave},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),a("markdown",{on:{rendered:function(t){return e.mdOutput=t}},model:{value:t.mdInput,callback:function(e){t.mdInput=e},expression:"mdInput"}}),a("file-picker",{on:{cleared:t.onFileClear},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),a("controls",{on:{send:t.sendMessages,clear:t.onClear}}),a("p",{directives:[{name:"show",rawName:"v-show",value:!t.formValid,expression:"!formValid"}],staticClass:"help is-danger"},[t._v("Please fill out the form before submitting")])],1)]),a("section",{staticClass:"section"},[a("div",{staticClass:"container"},[t.loading?a("div",{staticClass:"lds-dual-ring"}):t._e(),a("user-table",{attrs:{data:t.recipients}})],1)])],1)},x=[],R=(n("ls82"),n("MECJ")),S=n("qpph"),$=n("4Zaf"),E=n.n($),F=(n("rGqo"),n("yt8O"),n("iM3m")),T=n("vDqi"),M=n.n(T),N=10,P=function(){function e(t,n){Object(v["a"])(this,e),this.token=t,this.message=n,this.queue=new F["TaskQueue"](Promise,N)}return Object(S["a"])(e,[{key:"blastMessage",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map(this.queue.wrap(function(){var e=Object(R["a"])(regeneratorRuntime.mark(function e(t,a,s){var i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s[a].status="TRYING",e.prev=1,e.next=4,n.postMessage(t.email);case 4:i=e.sent,s[a].status="SUCCESS ".concat(i.status),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),e.t0.response?(console.log(e.t0.response.status),console.log(e.t0.response.headers),429===e.t0.response.status&&e.t0.response.headers&&(r=e.t0.response.headers["Retry-After"]||3e3,setTimeout(Object(R["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.postMessage(t.email);case 3:s[a].status="RETRY SUCCESS",e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),s[a].status="RETRY ERROR";case 9:case"end":return e.stop()}},e,this,[[0,6]])})),r)),s[a].status="RETRYING ".concat(e.t0.response.status)):(s[a].status="ERROR ".concat(e.t0.response.status),console.error(e.t0));case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,n,a){return e.apply(this,arguments)}}()))));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"postMessage",value:function(e){var t={headers:{Authorization:"Bearer ".concat(this.token)}},n={toPersonEmail:e,markdown:this.message};return M.a.post("https://api.ciscospark.com/v1/messages",n,t)}}]),e}(),q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n  Markdown Editor\n")]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("div",{staticClass:"control"},[n("textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"textarea is-primary",attrs:{type:"text",placeholder:"Enter your blast message",name:"message"},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)},change:e.saveInput}})]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("message"),expression:"errors.has('message')"}],staticClass:"help is-danger"},[e._v(e._s(e.errors.first("message")))])])]),n("div",{staticClass:"column"},[n("div",{staticClass:"box activity-text"},[n("vue-markdown",{attrs:{source:e.value},on:{rendered:e.onRender}})],1)])])])},A=[],I=n("nOak"),V=n.n(I),Y=function(e){function t(){var e;return Object(v["a"])(this,t),e=Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.output="",e}return Object(S["a"])(t,[{key:"saveInput",value:function(e){console.log("save input"),this.$store.dispatch("setRender",e.target.value)}},{key:"onRender",value:function(e){this.output=e,this.$emit("rendered",e)}}]),Object(h["a"])(t,e),t}(k["b"]);Y=g["a"]([Object(k["a"])({components:{VueMarkdown:V.a},inject:["$validator"],props:{value:String}})],Y);var K=Y,Z=K,B=(n("xcxa"),Object(o["a"])(Z,q,A,!1,null,"5d8101fe",null)),D=B.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n  Access Token\n")]),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control is-expanded"},[n("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|alpha_num",expression:"'required|alpha_num'"}],staticClass:"input is-primary",attrs:{required:"",type:"text",name:"token",placeholder:"Access Token"},domProps:{value:e.value},on:{input:function(t){e.$emit("input",t.target.value)}}})]),n("div",{staticClass:"control"},[n("a",{staticClass:"button is-info",on:{click:function(t){e.$emit("save")}}},[e._v("\n      Save\n    ")])])]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("token"),expression:"errors.has('token')"}],staticClass:"help is-danger"},[e._v(e._s(e.errors.first("token")))])])},U=[],z=function(e){function t(){return Object(v["a"])(this,t),Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(k["b"]);z=g["a"]([Object(k["a"])({inject:["$validator"],props:{value:String,displayName:String,isError:Boolean,isSuccess:Boolean}})],z);var H=z,J=H,L=(n("j95Z"),Object(o["a"])(J,G,U,!1,null,null,null)),Q=L.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n      File Selection\n    ")]),n("div",{staticClass:"field is-grouped"},[n("p",{staticClass:"control"}),n("div",{staticClass:"file"},[n("label",{staticClass:"file-label"},[n("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],ref:"csv",staticClass:"file-input",attrs:{type:"file",name:"csv",accept:".csv"},on:{change:e.handleFileChange}}),n("span",{staticClass:"file-cta"},[e._m(0),n("span",{staticClass:"file-label"},[e._v("\n          "+e._s(e.fileName||"Choose File")+"\n        ")])])])]),n("p"),n("p",{staticClass:"control"},[n("input",{staticClass:"button is-danger is-outlined",attrs:{type:"reset",value:"Remove File"},on:{click:e.clearFile}})]),e._m(1)])])},W=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"file-icon"},[n("i",{staticClass:"fas fa-upload"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"control"},[n("a",{staticClass:"button is-success",attrs:{href:"/blast_template.csv",download:""}},[e._v("\n      Download Template\n      ")])])}],ee=function(e){function t(){var e;return Object(v["a"])(this,t),e=Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.fileName="",e}return Object(S["a"])(t,[{key:"clearFile",value:function(e){var t=this.$refs.csv;t.value="",this.fileName="",this.$emit("cleared")}},{key:"handleFileChange",value:function(e){this.fileName=e.target.value,this.$emit("input",e.target.files[0])}}]),Object(h["a"])(t,e),t}(k["b"]);ee=g["a"]([Object(k["a"])({inject:["$validator"],props:{value:File}})],ee);var te=ee,ne=te,ae=Object(o["a"])(ne,X,W,!1,null,null,null),se=ae.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},[e._m(0),n("tbody",e._l(e.data,function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.id))]),n("td",[e._v(e._s(t.email))]),n("td",[e._v(e._s(t.status))])])}))])},re=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("#")]),n("th",[e._v("Email")]),n("th",[e._v("Status")])])])}],oe=function(e){function t(){return Object(v["a"])(this,t),Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(k["b"]);oe=g["a"]([Object(k["a"])({props:{data:Array}})],oe);var le=oe,ce=le,ue=(n("m2cr"),Object(o["a"])(ce,ie,re,!1,null,null,null)),pe=ue.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:e.onSend}},[e._v("Send")])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-link",on:{click:e.onSave}},[e._v("Save")])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-text",on:{click:e.onClear}},[e._v("Clear")])])])},fe=[],ve=function(e){function t(){return Object(v["a"])(this,t),Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(S["a"])(t,[{key:"onSend",value:function(e){this.$emit("send")}},{key:"onClear",value:function(e){this.$emit("clear")}},{key:"onSave",value:function(e){this.$emit("save")}}]),Object(h["a"])(t,e),t}(k["b"]);ve=g["a"]([Object(k["a"])({props:{isLoading:Boolean}})],ve);var he,me,be=ve,ge=be,ke=(n("agAK"),Object(o["a"])(ge,de,fe,!1,null,null,null)),je=ke.exports,Oe=function(e){function t(){var e;return Object(v["a"])(this,t),e=Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.recipients=[],e.mdInput="",e.mdOutput="",e.file=null,e.loading=!1,e.token="",e.formValid=!0,e}return Object(S["a"])(t,[{key:"mounted",value:function(){this.mdInput=this.$store.state.render,this.token=this.$store.state.token}},{key:"openFile",value:function(e,t){E.a.parse(e,{delimiter:",",header:!0,complete:this.onFileParse})}},{key:"onFileParse",value:function(e){this.recipients=e.data.map(function(e,t){return{email:e.email,status:"Ready",id:t}})}},{key:"sendMessages",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.mdOutput&&this.token&&this.file)){e.next=9;break}return this.formValid=!0,this.loading=!0,t=new P(this.$store.state.token,this.mdOutput),e.next=6,t.blastMessage(this.recipients);case 6:this.loading=!1,e.next=10;break;case 9:this.formValid=!1;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClear",value:function(){this.mdInput=""}},{key:"onFileClear",value:function(){this.recipients=[]}},{key:"onTokenSave",value:function(){this.$store.dispatch("setToken",this.token)}}]),Object(h["a"])(t,e),t}(k["b"]);g["a"]([Object(k["c"])("file"),g["b"]("design:type",Function),g["b"]("design:paramtypes",["function"===typeof(he="undefined"!==typeof File&&File)&&he||Object,"function"===typeof(me="undefined"!==typeof File&&File)&&me||Object]),g["b"]("design:returntype",void 0)],Oe.prototype,"openFile",null),Oe=g["a"]([Object(k["a"])({components:{Markdown:D,AccessToken:Q,FilePicker:se,UserTable:pe,Controls:je}})],Oe);var ye=Oe,Ce=ye,_e=Object(o["a"])(Ce,w,x,!1,null,null,null),we=_e.exports;a["default"].use(p["a"]);var xe=new p["a"]({routes:[{path:"/",name:"home",component:we},{path:"/about",name:"about",component:_}]}),Re=n("L2JU"),Se=n("XVfz"),$e=n.n(Se),Ee=new $e.a({storage:window.localStorage});a["default"].use(Re["a"]);var Fe=new Re["a"].Store({state:{token:"",render:""},mutations:{setToken:function(e,t){e.token=t},setRender:function(e,t){e.render=t}},actions:{setToken:function(e,t){e.commit("setToken",t)},setRender:function(e,t){e.commit("setRender",t)}},plugins:[Ee.plugin]}),Te=n("lIOY");Object(Te["a"])("".concat("/teams-blast-messenger/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("ksaK");var Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero is-primary"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v("\n        "+e._s(e.title)+"\n      ")]),e.subtitle?n("h2",{staticClass:"subtitle"},[e._v("\n        "+e._s(e.subtitle)+"\n      ")]):e._e()])])])},Ne=[],Pe=function(e){function t(){return Object(v["a"])(this,t),Object(m["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(k["b"]);Pe=g["a"]([Object(k["a"])({props:{title:String,subtitle:String}})],Pe);var qe=Pe,Ae=qe,Ie=(n("lHKg"),Object(o["a"])(Ae,Me,Ne,!1,null,null,null)),Ve=Ie.exports,Ye={classNames:{valid:"is-success",invalid:"is-danger"},classes:!0};a["default"].use(s["a"],Ye),a["default"].component("Hero",Ve),a["default"].config.productionTip=!1,new a["default"]({router:xe,store:Fe,render:function(e){return e(u)}}).$mount("#app")}});
//# sourceMappingURL=app.8b095c0d.js.map