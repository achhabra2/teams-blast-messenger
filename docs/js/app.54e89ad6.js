(function(e){function t(t){for(var s,i,o=t[0],c=t[1],l=t[2],p=0,f=[];p<o.length;p++)i=o[p],a[i]&&f.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},a={1:0},r=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/teams-blast-messenger/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;r.push([10,0]),n()})({10:function(e,t,n){e.exports=n("zUnb")},6:function(e,t){},7:function(e,t){},"9kDp":function(e,t,n){},EDI0:function(e,t,n){},GYlk:function(e,t,n){},MYyG:function(e,t,n){"use strict";var s=n("jKLi"),a=n.n(s);a.a},R7cQ:function(e,t,n){},Vd6l:function(e,t,n){},ZL7j:function(e,t,n){"use strict";var s=n("EDI0"),a=n.n(s);a.a},agAK:function(e,t,n){"use strict";var s=n("Vd6l"),a=n.n(s);a.a},j95Z:function(e,t,n){"use strict";var s=n("GYlk"),a=n.n(s);a.a},jKLi:function(e,t,n){},lHKg:function(e,t,n){"use strict";var s=n("R7cQ"),a=n.n(s);a.a},m2cr:function(e,t,n){"use strict";var s=n("9kDp"),a=n.n(s);a.a},zUnb:function(e,t,n){"use strict";n.r(t);n("VRzm");var s=n("Kw5r"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i=(n("ZL7j"),n("KHd+")),o={},c=Object(i["a"])(o,a,r,!1,null,null,null),l=c.exports,u=n("jE9Z"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"})},f=[],d=n("xmWZ"),v=n("3Aqn"),h=n("0yhX"),b=n("EdlT"),m=n("mrSG"),g=n("YKMj"),j=function(e){function t(){return Object(d["a"])(this,t),Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(v["a"])(t,e),t}(g["b"]);j=m["a"]([g["a"]],j);var O=j,k=O,y=Object(i["a"])(k,p,f,!1,null,null,null),C=y.exports,_=function(){var e=this,t=this,n=t.$createElement,s=t._self._c||n;return s("div",[s("hero",{attrs:{title:"Blast Message App"}}),t.loading?t._e():s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("access-token"),s("markdown",{on:{rendered:function(t){return e.mdOutput=t}},model:{value:t.mdInput,callback:function(e){t.mdInput=e},expression:"mdInput"}}),s("file-picker",{on:{cleared:t.onFileClear},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),s("controls",{on:{send:t.sendMessages,clear:t.onClear}})],1)]),s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("user-table",{attrs:{data:t.recipients}})],1)])],1)},w=[],x=(n("ls82"),n("MECJ")),R=n("qpph"),E=n("4Zaf"),$=n.n(E),S=(n("rGqo"),n("yt8O"),n("iM3m")),F=n("vDqi"),M=n.n(F),T=10,P=function(){function e(t,n){Object(d["a"])(this,e),this.token=t,this.message=n,this.queue=new S["TaskQueue"](Promise,T)}return Object(R["a"])(e,[{key:"blastMessage",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(this.queue.wrap(function(){var e=Object(x["a"])(regeneratorRuntime.mark(function e(t,s,a){var r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a[s].status="TRYING",e.prev=1,e.next=4,n.postMessage(t.email);case 4:r=e.sent,a[s].status="SUCCESS ".concat(r.status),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),e.t0.response?(console.log(e.t0.response.status),console.log(e.t0.response.headers),429===e.t0.response.status&&e.t0.response.headers&&(i=e.t0.response.headers["Retry-After"]||3e3,setTimeout(Object(x["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.postMessage(t.email);case 3:a[s].status="RETRY SUCCESS",e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),a[s].status="RETRY ERROR";case 9:case"end":return e.stop()}},e,this,[[0,6]])})),i)),a[s].status="RETRYING ".concat(e.t0.response.status)):(a[s].status="ERROR ".concat(e.t0.response.status),console.error(e.t0));case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,n,s){return e.apply(this,arguments)}}())));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"postMessage",value:function(e){var t={headers:{Authorization:"Bearer ".concat(this.token)}},n={toPersonEmail:e,markdown:this.message};return M.a.post("https://api.ciscospark.com/v1/messages",n,t)}}]),e}(),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n  Markdown Editor\n")]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("div",{staticClass:"field"},[n("div",{staticClass:"control"},[n("textarea",{staticClass:"textarea is-primary",attrs:{type:"text",placeholder:"Primary textarea"},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)},change:e.saveInput}})])])]),n("div",{staticClass:"column"},[n("div",{staticClass:"box activity-text"},[n("vue-markdown",{attrs:{source:e.value},on:{rendered:e.onRender}})],1)])])])},I=[],K=n("nOak"),Y=n.n(K),N=function(e){function t(){var e;return Object(d["a"])(this,t),e=Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.output="",e}return Object(R["a"])(t,[{key:"saveInput",value:function(e){console.log("save input"),this.$store.dispatch("setRender",e.target.value)}},{key:"onRender",value:function(e){this.output=e,this.$emit("rendered",e)}}]),Object(v["a"])(t,e),t}(g["b"]);N=m["a"]([Object(g["a"])({components:{VueMarkdown:Y.a},props:{value:String}})],N);var G=N,q=G,Z=(n("MYyG"),Object(i["a"])(q,A,I,!1,null,"0fe4d0d0",null)),U=Z.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n  Access Token\n")]),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control is-expanded"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.token,expression:"token"}],staticClass:"input is-primary",attrs:{type:"text",placeholder:"Access Token"},domProps:{value:e.token},on:{input:function(t){t.target.composing||(e.token=t.target.value)}}})]),n("div",{staticClass:"control"},[n("a",{staticClass:"button is-info",on:{click:e.onSave}},[e._v("\n      Save\n    ")])])])])},D=[],L=function(e){function t(){var e;return Object(d["a"])(this,t),e=Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.token="",e}return Object(R["a"])(t,[{key:"mounted",value:function(){this.token=this.$store.state.token}},{key:"onSave",value:function(e){this.$store.dispatch("setToken",this.token)}}]),Object(v["a"])(t,e),t}(g["b"]);L=m["a"]([g["a"]],L);var V=L,H=V,J=(n("j95Z"),Object(i["a"])(H,z,D,!1,null,null,null)),B=J.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("\n      File Selection\n    ")]),n("div",{staticClass:"field is-grouped"},[n("p",{staticClass:"control"}),n("div",{staticClass:"file"},[n("label",{staticClass:"file-label"},[n("input",{ref:"csv",staticClass:"file-input",attrs:{type:"file",name:"csv"},on:{change:e.handleFileChange}}),n("span",{staticClass:"file-cta"},[e._m(0),n("span",{staticClass:"file-label"},[e._v("\n          "+e._s(e.fileName||"Choose File")+"\n        ")])])])]),n("p"),n("p",{staticClass:"control"},[n("input",{staticClass:"button",attrs:{type:"reset",value:"Remove File"},on:{click:e.clearFile}})])])])},X=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"file-icon"},[n("i",{staticClass:"fas fa-upload"})])}],W=function(e){function t(){var e;return Object(d["a"])(this,t),e=Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.fileName="",e}return Object(R["a"])(t,[{key:"clearFile",value:function(e){var t=this.$refs.csv;t.value="",this.fileName="",this.$emit("cleared")}},{key:"handleFileChange",value:function(e){this.fileName=e.target.value,this.$emit("input",e.target.files[0])}}]),Object(v["a"])(t,e),t}(g["b"]);W=m["a"]([Object(g["a"])({props:{value:File}})],W);var ee=W,te=ee,ne=Object(i["a"])(te,Q,X,!1,null,null,null),se=ne.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},[e._m(0),n("tbody",e._l(e.data,function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.id))]),n("td",[e._v(e._s(t.email))]),n("td",[e._v(e._s(t.status))])])}))])},re=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("#")]),n("th",[e._v("Email")]),n("th",[e._v("Status")])])])}],ie=function(e){function t(){return Object(d["a"])(this,t),Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(v["a"])(t,e),t}(g["b"]);ie=m["a"]([Object(g["a"])({props:{data:Array}})],ie);var oe,ce,le=ie,ue=le,pe=(n("m2cr"),Object(i["a"])(ue,ae,re,!1,null,null,null)),fe=pe.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-primary",on:{click:function(t){e.$emit("send")}}},[e._v("Send")])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-link",on:{click:function(t){e.$emit("save")}}},[e._v("Save")])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-text",on:{click:function(t){e.$emit("clear")}}},[e._v("Clear")])])])},ve=[],he={},be=he,me=(n("agAK"),Object(i["a"])(be,de,ve,!1,null,null,null)),ge=me.exports,je=function(e){function t(){var e;return Object(d["a"])(this,t),e=Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.recipients=[],e.mdInput="",e.mdOutput="",e.file=null,e.loading=!1,e}return Object(R["a"])(t,[{key:"mounted",value:function(){this.mdInput=this.$store.state.render}},{key:"openFile",value:function(e,t){$.a.parse(e,{delimiter:",",header:!0,complete:this.onFileParse})}},{key:"onFileParse",value:function(e){console.log(e),this.recipients=e.data.map(function(e,t){return{email:e.email,status:"Ready",id:t}})}},{key:"sendMessages",value:function(){var e=Object(x["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t=new P(this.$store.state.token,this.mdOutput),e.next=4,t.blastMessage(this.recipients);case 4:this.loading=!1;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClear",value:function(){this.mdInput=""}},{key:"onFileClear",value:function(){this.recipients=[]}}]),Object(v["a"])(t,e),t}(g["b"]);m["a"]([Object(g["c"])("file"),m["b"]("design:type",Function),m["b"]("design:paramtypes",["function"===typeof(oe="undefined"!==typeof File&&File)&&oe||Object,"function"===typeof(ce="undefined"!==typeof File&&File)&&ce||Object]),m["b"]("design:returntype",void 0)],je.prototype,"openFile",null),je=m["a"]([Object(g["a"])({components:{Markdown:U,AccessToken:B,FilePicker:se,UserTable:fe,Controls:ge}})],je);var Oe=je,ke=Oe,ye=Object(i["a"])(ke,_,w,!1,null,null,null),Ce=ye.exports;s["default"].use(u["a"]);var _e=new u["a"]({routes:[{path:"/",name:"home",component:Ce},{path:"/about",name:"about",component:C}]}),we=n("L2JU"),xe=n("XVfz"),Re=n.n(xe),Ee=new Re.a({storage:window.localStorage});s["default"].use(we["a"]);var $e=new we["a"].Store({state:{token:"",render:""},mutations:{setToken:function(e,t){e.token=t},setRender:function(e,t){e.render=t}},actions:{setToken:function(e,t){e.commit("setToken",t)},setRender:function(e,t){e.commit("setRender",t)}},plugins:[Ee.plugin]}),Se=n("lIOY");Object(Se["a"])("".concat("/teams-blast-messenger/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("ksaK");var Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero is-primary"},[n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[e._v("\n        "+e._s(e.title)+"\n      ")]),e.subtitle?n("h2",{staticClass:"subtitle"},[e._v("\n        "+e._s(e.subtitle)+"\n      ")]):e._e()])])])},Me=[],Te=function(e){function t(){return Object(d["a"])(this,t),Object(h["a"])(this,Object(b["a"])(t).apply(this,arguments))}return Object(v["a"])(t,e),t}(g["b"]);Te=m["a"]([Object(g["a"])({props:{title:String,subtitle:String}})],Te);var Pe=Te,Ae=Pe,Ie=(n("lHKg"),Object(i["a"])(Ae,Fe,Me,!1,null,null,null)),Ke=Ie.exports;s["default"].component("Hero",Ke),s["default"].config.productionTip=!1,new s["default"]({router:_e,store:$e,render:function(e){return e(l)}}).$mount("#app")}});
//# sourceMappingURL=app.54e89ad6.js.map